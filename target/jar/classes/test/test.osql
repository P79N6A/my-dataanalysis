--name:test
--author:Administrator
--create time:2018-01-26 17:18


--FROM log_client
--SELECT user_id,other_id,from_unixtime(action_time),function_name
--where action_time  >=1518006600 AND
--(user_id in (9459861,9544830,9833397,9954530,9842064,9423370,9208176,9959566,9501967,9435358,9429019,9824622,9185300,9489274,9984466,9430337,9782830,9953146,9558781,9251664,9168713,9377121,9121120,9711962,9640175,9164752,9925463,9459490,9423714,9119030,9426814,9585227,9683347,9715242,9183934,9485455,9311025,9466196,9289360,9002093,9541943,9602045,9689652,9889220,9101085,9831807,9735463,9772137,9428983,9208894,9041351,9057377,9584232,9828684,9198458,9129184,9289934,9600335,9138867,9276548,9310360,9299583,9465601,9488792,9272555,9818278,9341132,9138266,9623633,9335983,9087237,9095730,9757740,9434301,9848459,9916538,9364349,9851537,9807352,9687479,9780976,9707463,9518323,9274201,9420180,9367108,9487285,9559062,9145622,9106919,9680094,9556148,9971208,9039827,9958929,9868483,9597794,9839731,9830238,9238961,9446229,9461471,9594672,9343565,9915959,9689582,9254566,9972622,9337345,9884533,9817967,9298750,9793533,9521331,9704038,9115728,9563141,9183109,9182966,9032950,9544894,9471060,9480831,9196168,9523189,9901964,9848297,9632343,9493968,9316376,9457855,9944910,9661603,9396508,9530165,9493133,9315253,9818721,9651695,9652059,9349409,9767186,9888102,9025336,9489110,9916758,9343338,9345211,9740196,9357524,9904754,9584959,9773922,9750581,9368670,9450625,9569357,9291786,9872888,9349914,9082012,9595270,9967370,9066852,9748067,9598486,9447037,9817033,9440885,9615530,9217104,9982760,9337120,9956692,9163836,9252865,9712794) or other_id in (9459861,9544830,9833397,9954530,9842064,9423370,9208176,9959566,9501967,9435358,9429019,9824622,9185300,9489274,9984466,9430337,9782830,9953146,9558781,9251664,9168713,9377121,9121120,9711962,9640175,9164752,9925463,9459490,9423714,9119030,9426814,9585227,9683347,9715242,9183934,9485455,9311025,9466196,9289360,9002093,9541943,9602045,9689652,9889220,9101085,9831807,9735463,9772137,9428983,9208894,9041351,9057377,9584232,9828684,9198458,9129184,9289934,9600335,9138867,9276548,9310360,9299583,9465601,9488792,9272555,9818278,9341132,9138266,9623633,9335983,9087237,9095730,9757740,9434301,9848459,9916538,9364349,9851537,9807352,9687479,9780976,9707463,9518323,9274201,9420180,9367108,9487285,9559062,9145622,9106919,9680094,9556148,9971208,9039827,9958929,9868483,9597794,9839731,9830238,9238961,9446229,9461471,9594672,9343565,9915959,9689582,9254566,9972622,9337345,9884533,9817967,9298750,9793533,9521331,9704038,9115728,9563141,9183109,9182966,9032950,9544894,9471060,9480831,9196168,9523189,9901964,9848297,9632343,9493968,9316376,9457855,9944910,9661603,9396508,9530165,9493133,9315253,9818721,9651695,9652059,9349409,9767186,9888102,9025336,9489110,9916758,9343338,9345211,9740196,9357524,9904754,9584959,9773922,9750581,9368670,9450625,9569357,9291786,9872888,9349914,9082012,9595270,9967370,9066852,9748067,9598486,9447037,9817033,9440885,9615530,9217104,9982760,9337120,9956692,9163836,9252865,9712794))
--AND  function_name in ('约玩发起','约玩取消','约玩成功');

--create table lsb as
--FROM log_game
--SELECT user_id,command,gold_change,gold_left,from_unixtime(action_time)
--where gold_change!=0 AND  user_id=8450495 ;


--drop table lsb;
--
--
--create table lsb as
--FROM log_game
--SELECT user_id,command,exp_change,`exp`,level,from_unixtime(action_time)
--where exp_change!=0 AND  user_id in (9050691,9006021,8436379,7219832,1008611) ;


--FROM log_client
--SELECT other_id,count(*)
--where function_name ='约玩发起' AND  other_id in (9000289,9001242,9001302,9002547,9005937,9007050,9007098,9011338,9012430,9012649,9013375,9013799,9014930,9015895,9018107,9018841,9020418,9021036,9022018,9022509,9022827,9023555,9025113,9026890,9027296,9027639,9027658,9029810,9030352,9031463,9032490,9032628,9033452,9033923,9038636,9042760,9042874,9043452,9043716,9044449,9048037,9049414,9050793,9051313,9052954,9054536,9054892,9055135,9058256,9060058,9061332,9061461,9062651,9062668,9063434,9065409,9065903,9065923,9065945,9066683,9068643,9069290,9070549,9075542,9078474,9078743,9080665,9080825,9084272,9084931,9085092,9085139,9085899,9086104,9086124,9086437,9087378,9091548,9091914,9091993,9092324,9096456,9096546,9098209,9098339,9098823,9098901,9100325,9100565,9101319,9101652,9102659,9104111,9104969,9106920,9111522,9112013,9113377,9113952,9114674,9115421,9116710,9120782,9122254,9122747,9124458,9125082,9126193,9127953,9128676,9128928,9129257,9129604,9129799,9131603,9132859,9134338,9134917,9135111,9135322,9135878,9137008,9137733,9138862,9139922,9141958,9143163,9144125,9144264,9144311,9144917,9146472,9147252,9148712,9149508,9150706,9152426,9153436,9153596,9154015,9154864,9155846,9155890,9156670,9157026,9157530,9161388,9163213,9164004,9164008,9164175,9164449,9164625,9166314,9170122,9171843,9172275,9172657,9173263,9174385,9175726,9177417,9180553,9181514,9182269,9182332,9183041,9183089,9183534,9184632,9184660,9185772,9186868,9187200,9187499,9188530,9188715,9192066,9192305,9193462,9194138,9194323,9195024,9197263,9198986,9199942,9200352,9200475,9200974,9201425,9202763,9202935,9203165,9203863,9204121,9205294,9206357,9206445,9207878,9209389,9209749,9212235,9213113,9213649,9214885,9215138,9218536,9218592,9219439,9223384,9223712,9224250,9225103,9225856,9225969,9227156,9227983,9228004,9230815,9230964,9232722,9234350,9234821,9235169,9236537,9236548,9237002,9237623,9239101,9241008,9241069,9241513,9242582,9242903,9243068,9244485,9245434,9248990,9251523,9254994,9257480,9258852,9258925,9259541,9259967,9264213,9265410,9265706,9266724,9268681,9273554,9275631,9276110,9277155,9278332,9278338,9279716,9280320,9281573,9281839,9282292,9282976,9283093,9287547,9287881,9288562,9288793,9289983,9290946,9293018,9295218,9298858,9299256,9299356,9299821,9300066,9300143,9300338,9300405,9300794,9302170,9304469,9305362,9306091,9309423,9310121,9311004,9311687,9312336,9312814,9313687,9315609,9317488,9317663,9319185,9319434,9319581,9323681,9325004,9325659,9326416,9328412,9328423,9330261,9331782,9331819,9333420,9333522,9334166,9334447,9336009,9336347,9338211,9339705,9341592,9344163,9344175,9344883,9345890,9350565,9350952,9352010,9352120,9355385,9356150,9356661,9357662,9360295,9361577,9366174,9368077,9369394,9369467,9370269,9370387,9370468,9370865,9372795,9374548,9375256,9376067,9376990,9378338,9380456,9381413,9381805,9381838,9386025,9386084,9387655,9388790,9390174,9391065,9392188,9394696,9395844,9397312,9397603,9399268,9399695,9400735,9401266,9401670,9403138,9403141,9407516,9407734,9409788,9411241,9411489,9411533,9411699,9413009,9414184,9414889,9415000,9416388,9417672,9418186,9418223,9418827,9419319,9419323,9420047,9420745,9420893,9424360,9428546,9428830,9429305,9429596,9430205,9431863,9436354,9437151,9437332,9437758,9438832,9440021,9440634,9440665,9441921,9442519,9445188,9445298,9446218,9446753,9448691,9449648,9450021,9450145,9450735,9450762,9452642,9452909,9453245,9454798,9455308,9457086,9457791,9458010,9460342,9461961,9462626,9462779,9464089,9465364,9465507,9466442,9466672,9468757,9470201,9471031,9472316,9473858,9475766,9477480,9480673,9482748,9483328,9483632,9484381,9485367,9485531,9489810,9490284,9490786,9491413,9491505,9491711,9492947,9493411,9494011,9494073,9498454,9498617,9500239,9501686,9501938,9502233,9502254,9503324,9505033,9505833,9506679,9507054,9510228,9510797,9511483,9514433,9516271,9516680,9517490,9517697,9518708,9521445,9522830,9523220,9524775,9527283,9527383,9527657,9527824,9529290,9532421,9536666,9537544,9537865,9539651,9540269,9540895,9542360,9543777,9543866,9544115,9545568,9545806,9547403,9547692,9549573,9549615,9550231,9550370,9550571,9550951,9551018,9551420,9551545,9554779,9555085,9555339,9557880,9558182,9558348,9558377,9558926,9559335,9564091,9564572,9565095,9566239,9566298,9568605,9569432,9570643,9571627,9571665,9571911,9572051,9573378,9573863,9574405,9574440,9574769,9575280,9575681,9576957,9578141,9580186,9580270,9580540,9581387,9581829,9582649,9583360,9583586,9584252,9585070,9586777,9590157,9590409,9592259,9592489,9593811,9594606,9597525,9597989,9599824,9600239,9603282,9603739,9605280,9606109,9607218,9609150,9611731,9613665,9615857,9616493,9616896,9617017,9618409,9619672,9621489,9623851,9625248,9626148,9627699,9630274,9631220,9632624,9633043,9634314,9636070,9636866,9637631,9637654,9637664,9639767,9643094,9643316,9646104,9646242,9646849,9648052,9648167,9650546,9650573,9650620,9650792,9651626,9652144,9652445,9653027,9653116,9653284,9656882,9657225,9659116,9659664,9661017,9661810,9662658,9662798,9662822,9663049,9663749,9665020,9665651,9668096,9668634,9670500,9671102,9672855,9678932,9679501,9681185,9681248,9681285,9681800,9682450,9683686,9686095,9688320,9689228,9689733,9690167,9690665,9691215,9691225,9691460,9691790,9692932,9695776,9696644,9698285,9700691,9701332,9701754,9702015,9702861,9703501,9704965,9705925,9706214,9706224,9707575,9708575,9709648,9710828,9710855,9711327,9711650,9711739,9712900,9714854,9719214,9719599,9720035,9720222,9722961,9724080,9724488,9724985,9726052,9726849,9728666,9729770,9729914,9730286,9730892,9731174,9731759,9733527,9734704,9736139,9736503,9738297,9738552,9738955,9739454,9739574,9739964,9741980,9742186,9746138,9746626,9747678,9749296,9751155,9752794,9752936,9752945,9753829,9753869,9754304,9755028,9755752,9759671,9761954,9764129,9766666,9766776,9766842,9769926,9770795,9772722,9773776,9776572,9776766,9777441,9779846,9780447,9781949,9782286,9782437,9782784,9782896,9783489,9783854,9787454,9787873,9787923,9788218,9788922,9788963,9789189,9792602,9793060,9795800,9797566,9798983,9799453,9801795,9802121,9802353,9802631,9807223,9808989,9809557,9810026,9810172,9810913,9811378,9811999,9813303,9814550,9815431,9818966,9819597,9821837,9822435,9822632,9822739,9824167,9826834,9827486,9830478,9832149,9832875,9833042,9834572,9835556,9835991,9837588,9837830,9839694,9839705,9844064,9846415,9848852,9850215,9850724,9850836,9852261,9852482,9853107,9854357,9854517,9855182,9855898,9856295,9857989,9858759,9859620,9860869,9861792,9862014,9862476,9862637,9862649,9865321,9865431,9865769,9866640,9866962,9870073,9870263,9870288,9870442,9873620,9875301,9877367,9877846,9878062,9878513,9878836,9880027,9881449,9884045,9884180,9885953,9888575,9889004,9889699,9890438,9890674,9891069,9891595,9892728,9892834,9893048,9893497,9893731,9893964,9894378,9894866,9895022,9895875,9896731,9896774,9897160,9897236,9897540,9898304,9898738,9899841,9900170,9900435,9902664,9904529,9904940,9906424,9906755,9907557,9907572,9908602,9908717,9909315,9910552,9911795,9913348,9917462,9917843,9918443,9919549,9920833,9921098,9923057,9923194,9923335,9927133,9927649,9927860,9928056,9928544,9929035,9930255,9930792,9931535,9934843,9935553,9936076,9941654,9941833,9944349,9944868,9945031,9945422,9945636,9947126,9947331,9947528,9947696,9948167,9948363,9952044,9953955,9956608,9958038,9958122,9958813,9959161,9959392,9959649,9960051,9960179,9961874,9962676,9962737,9963253,9965279,9966086,9969762,9972620,9972666,9974693,9975494,9975783,9976319,9977034,9977274,9979871,9979976,9980796,9981523,9981559,9982231,9983664,9984881)
--GROUP By other_id;


--FROM log_client
--SELECT *
--where function_name ='约玩连麦状态';

--from log_client
--select user_id,other_id,function_name,platform,source,release_version,idfa,data_info,from_unixtime(action_time)
--where user_id in (9192137,9877232) or other_id in (9192137,9877232);


--FROM log_client
--SELECT user_id,other_id,from_unixtime(action_time)
--where function_name ='约玩发起' AND  action_time BETWEEN  1518019200 AND  1518537600;

--拉取一下该主播在当天的发起连麦数
--FROM log_client
--SELECT count(*)
--where function_name ='约玩发起' AND  action_time BETWEEN  1519142400 and 1519228800
--AND  user_id in (9544804);


--FROM log_client
--SELECT count(*)
--where function_name ='约玩成功' AND  action_time BETWEEN  1519488000 AND  1519574400;

--create table lsb as
--SELECT user_id,command,gold_change,custom_field1,custom_field2,FROM_UNIXTIME(action_time)
--FROM log_game
--WHERE action_time BETWEEN 1519488000 AND 1519660800 AND  game_id=1004 AND command in ('游戏奖励','游戏竞猜')
--and gold_game_change=0;


--create table lsb  as
--SELECT user_id,command,gold_change,gold_left,from_unixtime(action_time),custom_field1,custom_field2
--FROM log_game
--where user_id=8191568 and command in ('游戏竞猜','游戏奖励','赠送礼物','赠送游戏币礼物');

--SELECT DISTINCT command
--FROM log_game
--where gold_change>0 and action_time BETWEEN  1515945600 and 1521043200;

--<<<<<<< .mine
--select lg.user_id, sum(gold_change), count(1)
--from log_game lg
--where lg.command = '幸运礼物' and custom_field2 like '%500'
--and action_time >= 1515945600 and custom_field1 = 20002
--group by lg.user_id;

--drop table lsb;
--create table lsb as
--select lg.user_id, lg.command, lg.gold_game_change, lg.gold_game_left,lg.room_name, from_unixtime(lg.action_time)
--from log_game lg
--where lg.user_id in( 8164030, 8504018) and lg.gold_game_change <> 0;
--
--||||||| .r24763
--select lg.user_id, sum(gold_change), count(1)
--from log_game lg
--where lg.command = '幸运礼物' and custom_field2 like '%500'
--and action_time >= 1515945600 and custom_field1 = 20002
--group by lg.user_id;
--=======
--CREATE table lsb as
--SELECT user_id,command,gold_change,gold_left,from_unixtime(action_time)
--FROM log_game
--WHERE user_id in (8950873,8914026) AND action_time BETWEEN 1519920000 AND 1520265600 AND  gold_change<>0;


--drop table lsb;


--SELECT SUM(charm_change)*0.004
--FROM log_game
--WHERE command='房间目标奖励' AND user_id=1653956 AND action_time BETWEEN 1520215200 AND 1520820000;


--SELECT partion_field,user_id,sum(charm_high_change)
--from log_game
--where command='主播竞猜激励' and action_time BETWEEN 1518624000 AND  1521129600
--GROUP BY partion_field,user_id;



-->>>>>>> .r25566
--select lg.user_id, from_unixtime(min(lg.action_time))
--from log_game as lg
--where lg.command = '游戏竞猜' and lg.user_id in (
--)
--group by lg.user_id;

--drop table lsb;
--create table lsb as
--select partion_field, lg.user_id, count(1), sum(gold_change), sum(gold_game_change)
--from log_game as lg
--where lg.command = '免费金币领取'
--and lg.action_time between 1522512000	and 1524499200
--group by partion_field, lg.user_id;

--drop table if exists lsb;
--create table lsb as
--select distinct lg.user_id
--from log_game lg
--where lg.command = '开始游戏'
--and lg.custom_field1 = '2'
--and lg.partion_field = '20180720' ;

--drop table if exists lsb2 ;
--create table lsb2 as
--select lg.user_id, if(lsb.user_id is not null, 1, 0)
--from log_game lg left join lsb on lsb.user_id = lg.user_id
--where lg.command = '用户注册'
--  and lg.partion_field = '20180720'
--  and lg.action_time between 1532084400	and 1532091600;


drop table if exists lsb3;
create table lsb3 as
select lsb2.user_id, lsb2._c1 as haoyoupipei, max(if (lil.user_id is not null, 1, 0)) as ciliu
from lsb2 left join login_log lil on lsb2.user_id = lil.user_id and lil.partion_field = '20180721'
group by lsb2.user_id, lsb2._c1;

